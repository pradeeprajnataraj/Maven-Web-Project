# Maven
# Build your Java project and run tests with Apache Maven.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/java

trigger:
- master

pool:
  name: Default
  demands:
    - agent.name -equals vm-ubuntu

steps:
- task: CmdLine@2
  inputs:
    script: |
      echo "Running on agent: $(Agent.Name)"
      echo "Current directory: $(Build.SourcesDirectory)"
      echo "Hello from Linux shell!"
      uname -a
      df -h
      whoami
      mvn --version
- task: Maven@3
  inputs:
    mavenPomFile: 'pom.xml'                 # Path to your pom.xml (relative to repo root)
    goals: 'clean install'                  # Maven goals/commands
    options: '-X'                           # (Optional) Add debug flags or profiles
    publishJUnitResults: true               # (Optional) useful for test reporting
    testResultsFiles: '**/surefire-reports/TEST-*.xml'  # Default test result pattern
    javaHomeOption: 'JDKVersion'            # Use predefined JDKs
    jdkVersionOption: '1.11'                # Choose version, adjust as per your setup
    mavenVersionOption: 'Default'
    mavenAuthenticateFeed: false
